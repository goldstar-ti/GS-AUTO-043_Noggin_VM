{% extends "base.html" %}

{% block title %}Service Status - Noggin Processor{% endblock %}

{% block content %}
<ul class="nav service-tabs" role="tablist">
    <li class="nav-item" role="presentation">
        <a href="{{ url_for('service_status', tab='web') }}" 
           class="nav-link {% if active_tab == 'web' %}active{% endif %}"
           role="tab">
            <span class="status-indicator {% if web_service.active %}running{% else %}stopped{% endif %}"></span>
            Web Dashboard
        </a>
    </li>
    <li class="nav-item" role="presentation">
        <a href="{{ url_for('service_status', tab='processor') }}" 
           class="nav-link {% if active_tab == 'processor' %}active{% endif %}"
           role="tab">
            <span class="status-indicator {% if processor_service.active %}running{% else %}stopped{% endif %}"></span>
            Processor Service
        </a>
    </li>
</ul>

{% if active_tab == 'web' %}
<div class="service-tab-content">
    <div class="d-flex justify-content-between align-items-center mb-3 pb-3 border-bottom">
        <div class="d-flex align-items-center gap-3">
            <h3 class="h5 mb-0">noggin-web</h3>
            {% if web_service.active %}
                <span class="badge bg-success">Running</span>
            {% else %}
                <span class="badge bg-danger">Stopped</span>
            {% endif %}
        </div>
        <div class="d-flex gap-4 text-muted small">
            <span>PID: <strong>{{ web_service.pid }}</strong></span>
            <span>State: <strong>{{ web_service.state }}/{{ web_service.substate }}</strong></span>
            {% if web_service.memory and web_service.memory != 'N/A' and web_service.memory != '[not set]' %}
                <span>Memory: <strong>{{ (web_service.memory|int / 1024 / 1024)|round(1) }} MB</strong></span>
            {% endif %}
        </div>
    </div>
    
    <h5 class="mb-2">Recent Logs</h5>
    <div class="log-container">{{ web_service.logs }}</div>
    
    <div class="commands-card">
        <h5>Management Commands</h5>
        <code>./manage_web_service.sh status</code>
        <code>./manage_web_service.sh restart</code>
        <code>./manage_web_service.sh logs-follow</code>
    </div>
</div>
{% endif %}

{% if active_tab == 'processor' %}
<div class="service-tab-content">
    <div class="d-flex justify-content-between align-items-center mb-3 pb-3 border-bottom">
        <div class="d-flex align-items-center gap-3">
            <h3 class="h5 mb-0">noggin-processor</h3>
            {% if processor_service.active %}
                <span class="badge bg-success">Running</span>
            {% else %}
                <span class="badge bg-danger">Stopped</span>
            {% endif %}
        </div>
        <div class="d-flex gap-4 text-muted small">
            <span>PID: <strong>{{ processor_service.pid }}</strong></span>
            <span>State: <strong>{{ processor_service.state }}/{{ processor_service.substate }}</strong></span>
            {% if processor_service.memory and processor_service.memory != 'N/A' and processor_service.memory != '[not set]' %}
                <span>Memory: <strong>{{ (processor_service.memory|int / 1024 / 1024)|round(1) }} MB</strong></span>
            {% endif %}
        </div>
    </div>
    
    <h5 class="mb-2">Recent Logs</h5>
    <div class="log-container">{{ processor_service.logs }}</div>
    
    <div class="commands-card">
        <h5>Management Commands</h5>
        <code>./manage_service.sh status</code>
        <code>./manage_service.sh restart</code>
        <code>./manage_service.sh follow</code>
    </div>
</div>
{% endif %}
{% endblock %}
